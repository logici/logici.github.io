layout:     post                    # 使用的布局（不需要改）
title:      APUE_BaseKnowledge                # 标题 
subtitle:   reading《Advanced Programming in the UNIX Environment》   #副标题
date:       2019-12-1              # 时间
author:     BY Logici                      # 作者
header-img: img/post-bg-2015.jpg    #这篇文章标题背景图片
catalog: true                       # 是否归档
tags:                               #标签
    - APUE

# Unix基础知识

- 1.操作系统概念：

严格意义上，它被定义为一种软件。它控制计算机硬件资源，提供程序运行环境。称为**内核**。

- 操作系统的作用：

所有操作系统都为他们所运行的程序提供**服务**。典型的服务包括：

执行新程序、打开文件、读文件、分配存储区、获得等钱时间等。

- Unix操作系统的体系结构

![unix_struct](\img\apue\first\unix_struct.PNG)

**系统调用（system call）**：内核的接口。

**共用函数库**后见在西永调用接口之上。

应用程序既可以使用共用函数库，又可以使用系统调用。

- 广义上，操作系统包括了内核和一些其他软件。这里的其他软件包括：系统实用程序、应用程序、shell以及共用函数库。所以，我们常说的linux操作系统，其实是GNU/Linux操作系统，因为说linux其实只是内核而已，GNU/Linux是内核加上一些外围的软件服务。

**2.登陆**

2.1登陆信息

在口令文件（通常是/ect/passwd文件）中可以查看登陆信息。

登录名：加密口令：数字用户据ID：数字组ID：注释字段：起始目录（/home/登陆名）：shell程序（/bin/bash）

2.2shell

shell是一个命令行解释器，它读取用户输入，执行命令。shell的用户输入通常来字于终端（交互式shell），或者来自于文件（shell脚本）。

**3.文件与目录**

3.1文件系统

包含了**目录**和**文件**的一种层次结构。起点是根（root、“/”）。

目录（directory）是一个包含目录项的文件。包含文件名和该文件的属性信息。属性信息是：文件类型（普通文件还是目录）、文件大小、文件所有者、文件权限、最后的修改时间等。stat和fstat可以返回包含所有文件属性的一个信息结构。

3.2文件名

目录中各个名字称为文件名（filename）。

3.3路径名

由斜线分隔一个或多个文件名组成的序列构成路径名（pathname）。以斜线开头的路径名称为**绝对路径（absolute pathname）**，否则为**相对路径（relative pathname）**

3.4工作路径

每个进程都由一个工作目录（working directory）。所有相对路径名都从工作目录开始解释。

3.5起始目录

登陆时，工作目录设置为起始目录（home directory），该起始目录从口令文件中响应的用户登陆项中取得。

- **4.输入和输出**

4.1文件描述符

文件描述符（file descriptor），内核用以标识一个特定进程栈正在访问的文件。

4.2标准输入、标准输出、标准错误

standard input 、standard output 、 standard error，一般情况下，三个描述符都链接向终端。

4.3不带缓冲的I/O

open、read、write、lseek、close提供了不带缓冲的I/O。不带缓冲，需要考虑BUFFSIAZE常量，它的不同取值将影响程序的效率。

4.4标准I/O

标准I/O函数为那么不带缓冲的I/O函数提供了一个带缓冲的接口，使用标准I/O函数无需担心如何选区最佳的缓冲区大小。

**5.程序和进程**

5.1程序

程序（program）是一个存储子啊磁盘上某个目录中的可执行文件，内核使用exec函数，将程序读入内存，并执行程序。

5.2进程和进程ID

程序执行实例称为进程（process）。Unix为保证每个进程都有一个唯一的数字标识符，称为几次呢还给你ID。

5.3进程控制

fork、exec、waitpid，这三个系统调用。

5.4线程和线程ID

一个进程内的所有线程共享同一地址空间、文件描述符、栈以及进程相关的属性，所以需要子啊访问共享数据时，采取同步措施以避免不一致性。

**6.出错除了**

整型变量errno通常被设置为具有特定消息的值。POSIX和ISO C将errno定义为一个符号，它扩展称为要给可i需改的整形左值，它可以是一个包含出错编号的整数，也可以是一个返回出错编号的指针函数。在多线程的处理方案上：

每个线程都有属于它自己的局部errno以避免一个线程干扰另一个线程。对于errno应当注意两条规则：1.如果没有出错，其值不会被例程清除。仅当函数的返回置命出错时，才检验其值。2.任何函数都不会将errno值设置为0，而且在<errno.h>中定义所有的常量都不为0.

C标准中有两个函数输出错误：

​	#incldue <sttring,h>

​	1.char *strerror(int errnum);

​	#icnlude <stdio.h>

​	2.void perror(cosnt char *msg);

6.1错误恢复

出错分为致命性和非致命性。一般致命性就直接程序就结束了。非致命性的，一般是暂时的（资源度短缺），一般采取等候一段时间，至于采取等待多长时间，怎么等，那就是策略问题了。

**7.用户标识**

7.1用户ID

口令文件登陆项中的用户ID（user ID），标识各个不同的用户。

7.2组ID

口令文件登陆项的组ID。这种机制允许同组的的各个成员之间共享资源（如文件）。

7.3附属组ID



**8.信号**

信号用于通知进程发生了某种情况。进程一般有如下3种信号处理方式：

​	1.忽略信号

​	2.按系统默认方式处理

​	3.提供一个函数，作为信号的响应。

产生中断的方法，分为中断键（ctrl + D）和退出键（ctrl + \）,他们被用于中断当前运行的进程。还有就是使用产生信号的方法调用kill函数。在一个进程中调用此函数可向另一个而进程发送发送一个i新年好。

**9.时间值**

9.1日历时间。该值是自卸掉世界时1970年1月1日00：00：00这个特定时间的以来所经过的秒数累积值。

9.2进程时间。也称为cpu时间，用以度量进程使用的中央处理器资源。进程时间以时钟滴答计算。

当度量一个进程的执行时间时，一个进程维护了3个进程时间值：

- 时钟时间：进程运行的时间总量，其值与系统中同时运行的进程数有关。
- 用户cpu时间：执行用户指令所用的时间量。
- 系统cpu时间：为该进程执行内核程序所经历的时间。



**10.系统调用和库函数**

![malloc&sbrk](\img\apue\first\malloc&sbrk.PNG)

![lib&system](img\apue\first\lib&system.PNG)

系统调用提供了最基本的功能接口，库函数在此基础上丰富了这个功能，方便开发者使用。



**练习：**

![exercise1](\img\apue\first\exercise1_1.PNG)

![exercise2](\img\apue\first\exercise1_2.PNG)

![answer](img\apue\first\answer.PNG)

